{% extends "base.html" %}
{% block title %}搜索结果{% if keyword %} - {{ keyword }}{% endif %} - 在线书店{% endblock %}

{% block content %}
<h3 class="mb-4">
    {% if keyword %}
        搜索 “{{ keyword }}” <small class="text-muted">共 {{ books|length }} 本</small>
    {% else %}
        全部图书 <small class="text-muted">共 {{ books|length }} 本</small>
    {% endif %}
</h3>

{% if books %}
<div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 row-cols-xl-4 g-4">
    {% for book in books %}
    <div class="col">
        <div class="card h-100 shadow-sm">
            {% if book.cover_url %}
                <img src="{{ book.cover_url }}" class="card-img-top book-card" alt="{{ book.title }}"
                     onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                <div class="cover-placeholder card-img-top d-none">无封面</div>
            {% else %}
                <div class="cover-placeholder card-img-top">无封面</div>
            {% endif %}
            <div class="card-body d-flex flex-column">
                <h6 class="card-title fw-bold">{{ book.title }}</h6>
                {% if book.publisher %}<p class="text-muted small mb-1">{{ book.publisher }}</p>{% endif %}
                <div class="d-flex align-items-center mb-2">
                    <span class="text-danger fw-bold fs-5">¥{{ "%.2f"|format(book.price) }}</span>
                    {% if book.rating > 0 %}
                        <small class="text-warning ms-auto">★ {{ book.rating }}/5.0</small>
                    {% endif %}
                </div>
                <div class="mt-auto">
                    <a href="{{ url_for('book_detail', book_id=book.book_id) }}" class="btn btn-primary btn-sm w-100">查看详情</a>
                </div>
            </div>
        </div>
    </div>
    {% endfor %}
</div>
{% else %}
<div class="alert alert-info text-center py-5">
    <p class="lead">未找到相关图书</p>
    <a href="{{ url_for('index') }}" class="btn btn-outline-primary">返回首页浏览热销</a>
</div>
{% endif %}
{% endblock %}